## Scripts in this folder
1. calc_sfs_null.py
2. calc_sfs_power_backward.py
3. calc_sfs_power_forward.py
4. calc_ehh_null.py
5. calc_ehh_power_backward.py
6. calc_ehh_power_forward.py
7. calc_ehh_backward.R
8. calc_ehh_forward.R

## Directory in this folder
1. my_module
    - Scripts
      - backward_trajectory.py
      - forward_trajectory.py
      - mbslib.py
      - mstools.py

## How to use

- Calculate power of sfs-based tests
  - scripts
    - calc_sfs_null.py generate null distribution of sfs-based statistis
    - calc_sfs_power_backward.py calculate power of sfs-based tests against the allele frequency in the current population
    - calc_sfs_power_forward.py calculate power of sfs-based tests against the age of derived allele

  - usage
    - script1: please modify parameters of the main function and execute.
      - filename(str): directory of sample sequences data generated by *ms*  
      - data_dir(str): directory of output file (percentile data of sfs-based statistics)
    - script2, 3: please modify parameters of the main function and execute.
      - mutation_ages(list): age of derived allele
      - current_frequency(list): allele frequency in the current population
      - sel_advantages(list): selection coefficient
      - data_dir(str): directory of sample sequences data generated by *mbs*
      - power_dir(str): directory of output file (power data of sfs-based tests)
      - percentile_data_dir(str): path to percentile data of sfs-based statistics
  - outputs
    - percentile_D_H_E.csv: percentile of sfs-based statistics (output of script1)
    - power_of_D_backward.csv: power of Tajima's *D* against the allele freqeuncy in the current population (output of script2)
    - power_of_D_forward.csv: power of Tajima's *D* against the age of derived allele (output of script3)
    - power_of_H_backward.csv: power of Fay and Wu's *H* against the allele freqeuncy in the current population (output of script2)
    - power_of_H_forward.csv: power of Fay and Wu's *H* against the age of derived allele (output of script3)


- Calculate power of haplotype-based statistics
  - scripts
    - calc_ehh_null.py generate null distribution of haplotype-based statistis
    - calc_ehh_power_backward.py calculate power of haplotype-based tests against the allele frequency in the current population
    - calc_ehh_power_forward.py calculate power of haplotype-based tests against the age of derived allele

  - usage
    - script4: please modify parameters of the main function and execute.
      - ms_data_dir(str): directory of sample sequences data generated by *mbs* (data is transformed into *ms* data format)
      - ehh_data_dir(str): directory of haplotype-based statistics data
      - percentile_data_dir: directory of output file (percentile data of haplotype-based statistics)
    - script5, 6: please modify parameters of the main function and execute.
      - mutation_ages(list): age of derived allele
      - current_frequency(list): allele frequency in the current population
      - sel_advantages(list): selection coefficient
      - ms_data_dir(str): directory of sample sequences data generated by *mbs*
      - power_dir(str): directory of output file (power data of haplotype-based tests)
      - percentile_data_dir(str): path to percentile data of haplotype-based statistics
  - outputs
    - rEHH_percentile.csv: percentile of rEHH statistics (output of script4)
    - iHS_percentile.csv: percentile of iHS statistics (output of script4)
    - power_rEHH_backward.csv: power of rEHH against the allele freqeuncy in the current population (output of script5)
    - power_rEHH_forward.csv: power of rEHH against the age of derived allele (output of script6)
    - power_iHS_backward.csv: power of iHS against the allele freqeuncy in the current population (output of script5)
    - power_iHS_forward.csv: power of iHS against the age of derived allele (output of script6)
