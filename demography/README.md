## Scripts in this folder
1. calc_sfs_null_expansion.py
2. calc_sfs_null_bottleneck.py
3. calc_sfs_power_expansion_mage.py
4. calc_sfs_power_expansion_con_on_freq.py
5. calc_sfs_power_bottleneck_mage.py
6. calc_sfs_power_bottleneck_con_on_freq.py
7. calc_ehh_null_expansion.py
8. calc_ehh_null_bottleneck.py
9. calc_ehh_power_expansion_mage.py
10. calc_ehh_power_expansion_con_on_freq.py
11. calc_ehh_power_bottleneck_mage.py
12. calc_ehh_power_bottleneck_con_on_freq.py
13. calc_EHH_demography_pyper.R
14. calc_EHH_under_expansion.R
15. calc_EHH_under_bottleneck.R


## Directory in this folder
1. my_module
    - Scripts
      - backward_trajectory.py
      - forward_trajectory.py
      - mbslib.py
      - mstools.py

## How to use

- Calculate power of sfs-based tests under demographic model
  - scripts
    - calc_sfs_null_expansion.py generate null distribution of sfs-based statistis under expansion model
    - calc_sfs_null_bottleneck.py generate null distribution of sfs-based statistis under bottleneck model
    - calc_sfs_power_expansion_mage.py calculate power of sfs-based tests under expansion against against the age of derived allele
    - calc_sfs_power_expansion_con_on_freq.py calculate power of sfs-based tests under expansion against the allele frequency in the current population
    - calc_sfs_power_bottleneck_mage.py calculate power of sfs-based tests under bottleneck against against the age of derived allele
    - calc_sfs_power_bottleneck_con_on_freq.py calculate power of sfs-based tests under bottleneck against the allele frequency in the current population

  - usage
    - script1, 2: please modify parameters of the main function and execute.
      - path_to_data(str): path to sample sequences data generated by *ms*  
      - percentile_dir(str): directory of output file (percentile data of sfs-based statistics)
      - For other demographic parameters in detail, please refer to manuscripts.
    - script3 ~ 6: please modify parameters of the main function and execute.
      - mutation_ages(list): age of derived allele
      - sel_advantages(list): selection coefficient
      - data_num(list): parameter for parallel computing. [1: n_cpu/2] is recommended.
      - data_dir(str): directory of sample sequences data generated by *mbs*
      - save_dir(str): directory of statistics data
      - power_dir(str): directory of output file (power data of sfs-based tests)
      - file_name(str): file name of output file (power data of sfs_based statistics)
      - percentile_data_dir(str): path to percentile data of sfs-based statistics
      - For other demographic parameters in detail, please refer to manuscripts.
  - outputs
    - percetile data(csv format) for each demographic model are generated in percetile_data_dir. (output of script1, 2)
    - power data(csv format) for each demographic model are generated in power_dir. (output of script 3 ~ 6)


- Calculate power of haplotype-based tests under demographic model
  - scripts
    - calc_ehh_null_expansion.py generate null distribution of sfs-based statistis under expansion model
    - calc_ehh_null_bottleneck.py generate null distribution of sfs-based statistis under bottleneck model
    - calc_ehh_power_expansion_mage.py calculate power of sfs-based tests under expansion against against the age of derived allele
    - calc_ehh_power_expansion_con_on_freq.py calculate power of sfs-based tests under expansion against the allele frequency in the current population
    - calc_ehh_power_bottleneck_mage.py calculate power of sfs-based tests under bottleneck against against the age of derived allele
    - calc_ehh_power_bottleneck_con_on_freq.py calculate power of sfs-based tests under bottleneck against the allele frequency in the current population

  - usage
    - script7, 8: please modify parameters of the main function and execute.
      - data_dir(str): path to sample sequences data
      - ehh_data_dir(str): directory of statistics data
      - percentile_data_dir(str): directory of output file (percentile data of haplotype-based statistics)
      - For other demographic parameters in detail, please refer to manuscripts.
    - script9 ~ 12: please modify parameters of the main function and execute.
      - mutation_ages(list): age of derived allele
      - sel_advantages(list): selection coefficient
      - data_num(list): parameter for parallel computing. [1: n_cpu/2] is recommended.
      - data_dir(str): directory of sample sequences data generated by *mbs*
      - ehh_data_dir(str): directory of statistics data
      - save_dir(str): directory of statistics data
      - power_dir(str): directory of output file (power data of sfs-based tests)
      - path_to_percentile(str): path to percentile data of haplotype-based statistics
      - For other demographic parameters in detail, please refer to manuscripts.
  - outputs
    - percetile data(csv format) for each demographic model are generated in percetile_data_dir. (output of script7, 8)
    - power data(csv format) for each demographic model are generated in power_dir. (output of script 9 ~ 12)
